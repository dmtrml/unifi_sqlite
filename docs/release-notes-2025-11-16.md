# Release Notes — 2025-11-16

## Highlights
- Импорт больше не привязан к одной схеме: добавлены пресеты ZenMoney и Monefy, которые описывают сопоставление колонок, правила нормализации и работу с переводами.
- Колонки CSV сопоставляются автоматически, если их названия совпадают (или имеют известные алиасы); при необходимости можно принудительно перезапустить автоматическое сопоставление кнопкой **Auto map**.
- Появился полноценный профиль Monefy: учитывает мультивалютные переводы (строки `To/From`), определяет тип операции по знаку суммы и строит transfer-транзакции по парам строк.
- Тип счёта при импорте подбирается автоматически по названию (наличные → Cash, вклад → Deposit, и т.д.), поэтому новые аккаунты сразу попадают в нужную категорию.
- Списки счетов во всём приложении теперь отсортированы по убыванию баланса.

## Technical
- Выделен интерфейс `ImportProfile`: каждый пресет описывает отображаемые поля, `inferMapping`, `normalizeRow` и `finalize`. ZenMoney и Monefy вынесены в `src/lib/import-profiles.ts`.
- Добавлена поддержка transfer stub’ов для импорта: Monefy разбирает пары `To/From`, учитывает обе валюты и создаёт единую транзакцию `transfer`.
- На шаге сопоставления появился селектор пресета, разный список полей и кнопка **Auto map** (ручной вызов `inferMapping`). Контроль над `localStorage` предотвращает зависание старого маппинга.
- В `/api/imports` при создании счёта используется helper `inferAccountType`, который на основе названия подбирает тип (`Cash`, `Deposit`, `Loan`, и т.д.).
- Хук `useAccounts` возвращает уже отсортированный список (по balance DESC), чтобы все страницы/компоненты отображали счета в одном порядке.

## Next Steps
- Добавить дополнительные пресеты (Monobank, CSV банков) по новой схеме.
- Ввести управление маппингами (например, сохранённые пресеты пользователя, сброс по кнопке).
- Документировать новый процесс импорта в README (инструкции по выбору пресета, работе с Auto map, расшифровка правил типов).
